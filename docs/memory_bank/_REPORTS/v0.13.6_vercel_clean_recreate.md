# Phase 6.3: Vercel Clean Recreate (v0.13.6)

**Date**: 2025-12-25
**Target**: `https://leuniversita.vercel.app`
**Commit Verified**: `35e34830a49e02416d468069ac2a9dd2cd8f8b25`
**Status**: ðŸ”´ FAILED (Configuration Drift)

## 1. Current State Analysis
The remote verification (Smoke Test) returned **404 Not Found** for all API routes, including the new `/api/health`.
This confirms that Vercel is likely building from the repository root or has an invalid configuration for the monorepo structure, ignoring the `apps/pilot-web` directory where the Next.js app resides.

## 2. Action Plan: Clean Recreate (Manual Steps)
To resolve the configuration drift permanently, please perform the following "Clean Recreate" steps in the Vercel Dashboard.

### Step A: Create New Project
1.  Go to **Vercel Dashboard**.
2.  Click **"Add New..."** > **"Project"**.
3.  Import the repository: `leuniversita`.

### Step B: Configure Project Settings (CRITICAL)
Before clicking "Deploy", expand **"Edit"** next to the detected settings or go to **Build & Development Settings**:

| Setting | Value | Notes |
| :--- | :--- | :--- |
| **Framework Preset** | `Next.js` | Should auto-detect. |
| **Root Directory** | `apps/pilot-web` | **REQUIRED**. Click "Edit" and select this folder. |
| **Build Command** | `npm run build` | Default for Next.js. |
| **Output Directory** | `.next` | Default. |
| **Install Command** | `npm install` | Default. |

### Step C: Configure Environment Variables
Copy these exact values from your local `.env` or `apps/pilot-web/.env.local` to Vercel **Environment Variables**:

| Variable Name | Value Scopes |
| :--- | :--- |
| `NEXT_PUBLIC_SUPABASE_URL` | Production, Preview, Development |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | Production, Preview, Development |

*(Note: `OPENAI_API_KEY` and `SUPABASE_SERVICE_ROLE_KEY` are used by Supabase Edge Functions, not this Vercel Proxy, so they are not strictly required here unless logic changes).*

### Step D: Deploy
1.  Click **"Deploy"**.
2.  Wait for the build to complete (should take ~1-2 mins).
3.  **Verify**: The deployment URL should show the landing page, not a 404 or directory listing.

## 3. Remote Verification (After Deploy)
Once the deployment is marked "Ready" (Green), run the following command locally to verify:

```bash
bash scripts/test/smoke_v2_remote.sh
```

### Expected Output
- **Health Check**: `âœ… Health Check Passed (API Reachable)`
- **Start**: `âœ… Start Success`
- **Plan**: `âœ… Plan Success`

## 4. Verdict
**READY FOR PILOT**: **NO** (Pending Vercel Reconfiguration)
*The system code is ready (v0.13.5), but the deployment infrastructure requires the manual correction described above.*
