---
id: TEST-012-2
title: v0.12.2 Smoke Test Checklist
owner: QA
status: draft
created_at: 2025-12-21
updated_at: 2025-12-21
tags: [test, smoke, v2, api]
related: [ARCH-API-V2]
source_of_truth: docs/memory_bank/_REPORTS
mermaid: required
---

# v0.12.2 Smoke Test Checklist

Checklist per validare l'implementazione di Schema V2 e API Proxy.

## 1. Database & Seed
- [ ] Database migrated con `20251219...schema_v2.sql` (Tables `learning_attempts_v2`, `learning_progress_v2` created).
- [ ] Seed eseguito (`scripts/seed/schema_v2_seed.sql`).
- [ ] Tabella `assessments` contiene almeno 1 record 'diagnostic'.
- [ ] Tabella `questions` contiene domande collegate.

## 2. API Endpoints
### POST /api/diagnostic/start
- [ ] **Request**: `{ "courseId": "..." }`
- [ ] **Response 200**: `{ "attemptId": "...", "questions": [...] }`
- [ ] **Verify**: Record creato in `learning_attempts_v2`.

### POST /api/diagnostic/submit
- [ ] **Request**: `{ "attemptId": "...", "answers": [...] }`
- [ ] **Response 200**: `{ "score": ..., "placementLevel": "...", "planId": "..." }`
- [ ] **Verify**: Record creato in `learning_answers_v2`, Attempt status 'completed', Plan creato in `learning_plans`.

### GET /api/plan/current
- [ ] **Request**: `?courseId=...`
- [ ] **Response 200**: `{ "planId": "...", "level": "..." }`

### GET /api/progress
- [ ] **Request**: `?courseId=...`
- [ ] **Response 200**: `{ "modules": [...] }`

## 3. Sequence Validated
```mermaid
sequenceDiagram
    participant C as Client
    participant N as NextJS Proxy
    participant E as Edge Function
    participant D as DB (V2)

    C->>N: POST /start
    N->>E: invoke('diagnostic-start')
    E->>D: Insert Attempt V2
    D-->>E: Created
    E-->>N: JSON
    N-->>C: JSON
```
